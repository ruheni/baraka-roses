# Migration `20200709102801-postgres-db-added`

This migration has been generated by ruheni at 7/9/2020, 10:28:01 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Role" AS ENUM ('SALES_EXEC', 'GENERAL_MANAGER', 'STOCK_CLERK', 'ADMIN');

CREATE TYPE "Grade" AS ENUM ('GRADED', 'UNGRADED');

CREATE TYPE "Color" AS ENUM ('WHITE', 'LILAC', 'PINK', 'CERISE', 'RED', 'ORANGE', 'YELLOW', 'PEACH', 'BI_COLOUR');

CREATE TYPE "OrderStatus" AS ENUM ('PENDING', 'REVIEWED', 'CANCELLED');

CREATE TABLE "public"."Customer" (
"contactName" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"id" SERIAL,"market" text  NOT NULL ,"name" text  NOT NULL ,"phoneNumber" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Order" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"customerId" integer   ,"date" timestamp(3)  NOT NULL ,"finalQuantity" integer  NOT NULL ,"id" SERIAL,"initialQuantity" integer  NOT NULL ,"status" "OrderStatus" NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Product" (
"color" "Color" NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"grade" "Grade" NOT NULL ,"id" SERIAL,"length" integer  NOT NULL ,"orderId" integer   ,"quantity" integer  NOT NULL ,"variety" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Agent" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"customerId" integer   ,"email" text  NOT NULL ,"id" SERIAL,"name" text  NOT NULL ,"phoneNumber" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."User" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"firstName" text  NOT NULL ,"id" SERIAL,"lastName" text  NOT NULL ,"password" text  NOT NULL ,"role" "Role" NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "Customer.email" ON "public"."Customer"("email")

CREATE UNIQUE INDEX "Agent.email" ON "public"."Agent"("email")

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

ALTER TABLE "public"."Order" ADD FOREIGN KEY ("customerId")REFERENCES "public"."Customer"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Product" ADD FOREIGN KEY ("orderId")REFERENCES "public"."Order"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Agent" ADD FOREIGN KEY ("customerId")REFERENCES "public"."Customer"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200630225749-db-update-2..20200709102801-postgres-db-added
--- datamodel.dml
+++ datamodel.dml
@@ -1,93 +1,94 @@
 datasource postgres {
-    provider = "postgres"
-    url = "***"
+  provider = "postgres"
+  url = "***"
 }
 model Customer {
-    id          Int      @id @default(autoincrement())
-    name        String
-    contactName String
-    market      String
-    email       String   @unique
-    phoneNumber String
-    orders      Order[]
-    agents      Agent[]
-    createdAt   DateTime @default(now())
+  id          Int      @id @default(autoincrement())
+  name        String
+  contactName String
+  market      String
+  email       String   @unique
+  phoneNumber String
+  orders      Order[]
+  agents      Agent[]
+  createdAt   DateTime @default(now())
 }
 model Order {
-    id              Int         @id @default(autoincrement())
-    initialQuantity Int
-    finalQuantity   Int
-    status          OrderStatus
-    date            DateTime
-    Customer        Customer?   @relation(fields: [customerId], references: [id])
-    customerId      Int?
-    product         Product[]
-    createdAt       DateTime    @default(now())
+  id              Int         @id @default(autoincrement())
+  initialQuantity Int
+  finalQuantity   Int
+  status          OrderStatus
+  date            DateTime
+  Customer        Customer?   @relation(fields: [customerId], references: [id])
+  customerId      Int?
+  products        Product[]
+  createdAt       DateTime    @default(now())
 }
 model Product {
-    id        Int      @id @default(autoincrement())
-    color     Color
-    length    Int
-    grade     Grade
-    variety   String
-    quantity  Int
-    Order     Order?   @relation(fields: [orderId], references: [id])
-    orderId   Int?
-    createdAt DateTime @default(now())
+  id        Int      @id @default(autoincrement())
+  color     Color
+  length    Int
+  grade     Grade
+  variety   String
+  quantity  Int
+  Order     Order?   @relation(fields: [orderId], references: [id])
+  orderId   Int?
+  createdAt DateTime @default(now())
 }
 model Agent {
-    id          Int       @id @default(autoincrement())
-    name        String
-    phoneNumber String
-    email       String
-    Customer    Customer? @relation(fields: [customerId], references: [id])
-    customerId  Int?
+  id          Int       @id @default(autoincrement())
+  name        String
+  phoneNumber String
+  email       String    @unique
+  Customer    Customer? @relation(fields: [customerId], references: [id])
+  customerId  Int?
+  createdAt   DateTime  @default(now())
 }
 model User {
-    id        Int      @id @default(autoincrement())
-    firstName String
-    lastName  String
-    email     String
-    password  String
-    role      Role
-    createdAt DateTime @default(now())
+  id        Int      @id @default(autoincrement())
+  firstName String
+  lastName  String
+  email     String   @unique
+  password  String
+  role      Role
+  createdAt DateTime @default(now())
 }
 enum Role {
-    SALES_EXEC
-    GENERAL_MANAGER
-    STOCK_CLERK
-    ADMIN
+  SALES_EXEC
+  GENERAL_MANAGER
+  STOCK_CLERK
+  ADMIN
 }
 enum Grade {
-    GRADED
-    UNGRADED
+  GRADED
+  UNGRADED
 }
 enum Color {
-    WHITE
-    LILAC
-    PINK
-    CERISE
-    RED
-    ORANGE
-    YELLOW
-    PEACH
-    BI_COLOUR
+  WHITE
+  LILAC
+  PINK
+  CERISE
+  RED
+  ORANGE
+  YELLOW
+  PEACH
+  BI_COLOUR
 }
 enum OrderStatus {
-    PENDING
-    REVIEWED
-    CANCELLED
+  PENDING
+  REVIEWED
+  CANCELLED
 }
 generator prisma_client {
-    provider = "prisma-client-js"
+  provider = "prisma-client-js"
 }
```
